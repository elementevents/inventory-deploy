import{z as f,u as C,b as v,m as S,n as N,av as y,j as e,F,o,p as l,q as i,t as b,I as w,v as c}from"./index-BMUnmdqr.js";import{t as _}from"./zod-DYomLQ2Y.js";import{B as L}from"./Button-C3faAAMM.js";import{C as u}from"./Combobox-bo-92e8u.js";import{u as q,D as x}from"./useCountTypes-BgnHlvAL.js";import{F as E}from"./FormSkeleton-B1V-cM8C.js";import{u as T}from"./useMutation-JZ99Hdu2.js";import{q as k}from"./constants-BmjxfpbN.js";import{c as A}from"./counts-B443oyfY.js";import{a as D}from"./useStores-bJNqGH7k.js";import"./chevrons-up-down-D07Nc21u.js";import"./skeleton-DN6zr0st.js";import"./stores-D2R6uobw.js";function I(){const m=f(),r=C(),{toast:d}=v();return T({mutationFn:s=>A(s),onSuccess:()=>{m.invalidateQueries({queryKey:k.counts.all}),r({to:"/counts"}),d({title:"Count created successfully!",description:"The count has been created."})},onError:s=>{let a="Something went wrong!";(S(s)||s instanceof Error)&&(a=s.message),d({title:"Failed to create count!",description:a,variant:"destructive"})}})}function W(){const{data:m,error:r,isLoading:d}=D(),{data:s,error:a,isLoading:h}=q(),j=I(),n=N({defaultValues:{count_type_id:"",name:"",store_id:""},resolver:_(y)});async function p(t){await j.mutateAsync(t)}const g=()=>d||h?e.jsx(E,{}):r||a?e.jsxs("p",{className:"text-center text-red-500",children:["Error: ",(r==null?void 0:r.message)||(a==null?void 0:a.message)]}):m?s?e.jsx(F,{...n,children:e.jsxs("form",{className:"max-w-2xl",onSubmit:n.handleSubmit(p),children:[e.jsx("div",{className:"w-full grid gap-2",children:e.jsx(o,{control:n.control,name:"name",render:({field:t})=>e.jsxs(l,{className:"w-full",children:[e.jsx(i,{children:"Name"}),e.jsx(b,{children:e.jsx(w,{placeholder:"Count name",required:!0,...t})}),e.jsx(c,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(o,{control:n.control,name:"start_at",render:({field:t})=>e.jsxs(l,{className:"flex flex-col",children:[e.jsx(i,{children:"Start date"}),e.jsx(x,{onSelect:t.onChange,selected:t.value}),e.jsx(c,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(o,{control:n.control,name:"end_at",render:({field:t})=>e.jsxs(l,{className:"flex flex-col",children:[e.jsx(i,{children:"End date"}),e.jsx(x,{onSelect:t.onChange,selected:t.value}),e.jsx(c,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(o,{control:n.control,name:"store_id",render:({field:t})=>e.jsxs(l,{children:[e.jsx(i,{children:"Store"}),e.jsx(u,{items:m??[],onValueChange:t.onChange,placeholder:"Select a store",value:t.value}),e.jsx(c,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(o,{control:n.control,name:"count_type_id",render:({field:t})=>e.jsxs(l,{children:[e.jsx(i,{children:"Count type"}),e.jsx(u,{items:s??[],onValueChange:t.onChange,placeholder:"Select a count type",value:t.value}),e.jsx(c,{})]})})}),e.jsx(L,{className:"w-full mt-8",isLoading:n.formState.isSubmitting,label:"Save",loadingLabel:"Saving...",type:"submit"})]})}):e.jsx("p",{className:"text-center text-red-500",children:"Can't fetch stores data."}):e.jsx("p",{className:"text-center text-red-500",children:"Can't fetch stores data."});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:"Add Count"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create a new count."})]})}),e.jsx("div",{children:g()})]})}export{W as component};
