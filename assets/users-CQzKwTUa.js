import{s,ab as w,b0 as p,b1 as g}from"./index-BtYb8-V0.js";import{D as y,a as h}from"./constants-CRsvxbNR.js";async function k(){const{data:o,error:r}=await s.rpc("get_users_with_roles").order("employee_number",{ascending:!0});if(r)throw r;return o}async function F({pageIndex:o=y,pageSize:r=h,q:e,sortBy:t}){const a=o*r,c=a+r-1;let n=s.rpc("get_users_with_roles",void 0,{count:"exact"}).range(a,c);e&&e.trim()&&(n=n.or(`employee_number.ilike.%${e}%,last_name.ilike.%${e}%,first_name.ilike.%${e}%`)),t&&t.length>0?t.split(",").forEach(f=>{const[_,m]=f.split("."),d=_;n=n.order(d,{ascending:m==="asc"})}):n=n.order("employee_number",{ascending:!0});const{data:u,error:i,count:l}=await n;if(i)throw i;return{result:u,total:l??0}}async function v(o){const{data:r,error:e}=await s.rpc("get_user_with_role",{p_id:o}).single();if(e)throw e;return r}async function A(o){const{error:r}=await s.functions.invoke("create-user",{body:o});if(r)throw r}async function D(o,r){const{data:e,error:t}=await s.rpc("update_user",{p_id:o,p_first_name:r.first_name,p_last_name:r.last_name,p_role:r.role});if(t)throw t;return e}async function x(o,r){const{error:e}=await s.functions.invoke("reset-user-password",{body:{user_id:o,...r}});if(e)throw e}async function P(o,r){const{error:e}=await s.functions.invoke("update-user-email",{body:{user_id:o,new_email:r.new_email}});if(e instanceof w){const t=await e.context.json();throw console.log("Function returned an error",t),new Error(t.error)}else{if(e instanceof p)throw console.log("Relay error:",e.message),new Error(e.message);if(e instanceof g)throw console.log("Fetch error:",e.message),new Error(e.message)}}async function $(o){const{error:r}=await s.functions.invoke("import-users",{body:o.map(e=>({employee_number:e.employee_number.toString(),email:e.email,first_name:e.first_name,last_name:e.last_name,password:e.password}))});if(r)throw r}async function G(o){const{error:r}=await s.functions.invoke("toggle-user-active",{body:{user_id:o}});if(r)throw r}export{D as a,P as b,A as c,v as d,F as e,k as l,x as r,G as t,$ as u};
