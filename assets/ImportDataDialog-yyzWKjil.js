import{P as j,r as u,b as y,n as D,a3 as v,j as e,a4 as I,a5 as C,B as h,a6 as F,F as S,a7 as b,a8 as w,a9 as N,o as P,p as E,t as T,I as O,v as k,aa as L,L as B}from"./index-CpGbhIT2.js";import{t as U}from"./zod-3hOTAzBF.js";import{U as z}from"./upload-BMLMxmRs.js";async function H(i){return new Promise((l,c)=>{j.parse(i,{complete:a=>l(a),dynamicTyping:!0,error:a=>c(a),header:!0,skipEmptyLines:!0,transform:a=>a.trim()})})}function _({onSuccess:i,processor:l,schema:c,templateUrl:a}){const[n,d]=u.useState(!1),[f,m]=u.useState(!1),{toast:p}=y(),t=D({defaultValues:{file:void 0},resolver:U(v)});async function x({file:s}){try{d(!0);const{data:r}=await H(s),o=c.parse(r);await l(o),i(),m(!1),t.reset(),p({title:"Data Imported",description:"The data has been imported successfully."})}catch(r){console.log(r),p({title:"Error",description:"Failed to import data. Please try again.",variant:"destructive"})}finally{d(!1)}}const g=s=>{n||(m(s),s||t.reset())};return e.jsxs(I,{open:f,onOpenChange:g,children:[e.jsx(C,{asChild:!0,children:e.jsxs(h,{className:"ml-auto h-8 gap-1",onClick:()=>m(!0),size:"sm",variant:"outline",children:[e.jsx(z,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"sr-only sm:not-sr-only sm:whitespace-nowrap",children:"Import"})]})}),e.jsx(F,{className:"sm:max-w-md",children:e.jsx(S,{...t,children:e.jsxs("form",{className:"space-y-4",onSubmit:t.handleSubmit(x),children:[e.jsxs(b,{children:[e.jsx(w,{children:"Import Data"}),e.jsxs(N,{children:["Select a .csv file to import data."," ",e.jsx("a",{className:"text-accent-elementEventsSolutions underline",href:a,rel:"noreferrer",target:"_blank",children:"See template."})]})]}),e.jsx(P,{control:t.control,name:"file",render:({field:s})=>e.jsxs(E,{children:[e.jsx(T,{children:e.jsx(O,{type:"file",accept:".csv",onChange:r=>{var o;s.onChange((o=r.target.files)==null?void 0:o[0])}})}),e.jsx(k,{})]})}),e.jsx(L,{className:"sm:justify-start",children:e.jsxs(h,{disabled:n,type:"submit",children:[n&&e.jsx(B,{className:"h-4 w-4 animate-spin"}),!n&&"Import"]})})]})})})]})}export{_ as I};
