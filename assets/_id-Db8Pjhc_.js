import{z as j,u as v,b as g,m as y,aq as N,n as F,ar as b,r as S,j as e,F as _,q as w,I as C,o as u,t as m,ap as d,v as f}from"./index-D3bXZu3I.js";import{t as q}from"./zod-UQtKJp0L.js";import{B as U}from"./Button-CzAHEnXi.js";import{F as E}from"./FormSkeleton-DNZMpegM.js";import{u as k}from"./skeleton-BVqiyGzt.js";import{q as o}from"./constants-CTS4Tt_R.js";import{a as L,r as K,u as Q}from"./units-B_x4RDd2.js";import{u as A}from"./useMutation-CfvKCtdd.js";import{S as x}from"./switch-C5-2lREW.js";function M(a){return k({queryKey:o.units.detail(a),queryFn:()=>L(a),enabled:!!a})}function R(a){const s=j(),r=v(),{toast:l}=g();return A({mutationFn:async i=>{i.is_default&&await K(),await Q(a,i)},onSuccess:()=>{s.invalidateQueries({queryKey:o.units.detail(a)}),s.invalidateQueries({queryKey:o.units.lists()}),r({to:"/units"}),l({title:"Unit updated successfully!",description:"The unit has been updated."})},onError:i=>{let t="Something went wrong!";(y(i)||i instanceof Error)&&(t=i.message),l({title:"Failed to update unit!",description:t,variant:"destructive"})}})}function O(){const{id:a}=N.useParams(),{data:s,error:r,isLoading:l}=M(a),i=R(a),t=F({resolver:q(b),values:{is_active:(s==null?void 0:s.is_active)??!1,is_default:(s==null?void 0:s.is_default)??!1}}),{reset:c}=t;S.useEffect(()=>{s&&c({is_active:s.is_active,is_default:s.is_default})},[s,c]);async function h(n){await i.mutateAsync(n)}const p=()=>l?e.jsx(E,{}):r?e.jsxs("p",{className:"text-red-500",children:["Error: ",r.message]}):s?e.jsx(_,{...t,children:e.jsxs("form",{className:"max-w-2xl",onSubmit:t.handleSubmit(h),children:[e.jsx("div",{className:"w-full grid gap-2",children:e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx(w,{children:"Name"}),e.jsx(C,{placeholder:"Unit name",value:s.name,disabled:!0,required:!0})]})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(u,{control:t.control,name:"is_default",render:({field:n})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{children:e.jsx(x,{checked:n.value,onCheckedChange:n.onChange})}),e.jsx(d,{className:"ml-1",htmlFor:"is_default",children:"is default"}),e.jsx(f,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(u,{control:t.control,name:"is_active",render:({field:n})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(m,{children:e.jsx(x,{checked:n.value,onCheckedChange:n.onChange})}),e.jsx(d,{className:"ml-1",htmlFor:"is_active",children:"is active"}),e.jsx(f,{})]})})}),e.jsx(U,{className:"w-full mt-8",isLoading:t.formState.isSubmitting,label:"Save",loadingLabel:"Saving...",type:"submit"})]})}):e.jsx("p",{className:"text-red-500",children:"Can't fetch store data."});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:"Update Unit"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update a unit."})]})}),e.jsxs("div",{children:[" ",p()]})]})}export{O as component};
