import{A as w,u as S,b as q,m as L,aE as k,n as E,aF as Q,r as U,j as e,F as T,q as l,I as u,o as d,p as x,t as h,v as c,aq as f}from"./index-BNKejGDJ.js";import{t as A}from"./zod-CqOwETNO.js";import{B as I}from"./Button-D3voXEKB.js";import{C as K}from"./Combobox-3mW3KZ7u.js";import{u as $,S as B}from"./skeleton-LSo8Me7d.js";import{F as M}from"./FormSkeleton-D8h1llPL.js";import{q as j}from"./constants-CTS4Tt_R.js";import{r as R,u as V}from"./countDetails-DkPTQYVh.js";import{a as P}from"./useUnits-CVtcYLk-.js";import{u as z}from"./useMutation-Dqt9WjfM.js";import{S as v}from"./switch-C3fZvfib.js";import{T as G}from"./textarea-DDDAL2Pa.js";import"./chevrons-up-down-B5NHiEAQ.js";import"./units-CWaf6Pk8.js";function H(n){return $({queryKey:j.countDetails.detail(n),queryFn:async()=>R(n)})}function J(n){const r=w(),o=S(),{toast:m}=q();return z({mutationFn:s=>V(n,s),onSuccess:()=>{r.invalidateQueries({queryKey:j.countDetails.detail(n)}),r.invalidateQueries({queryKey:j.countDetails.lists()}),o({to:"/count_details"}),m({title:"Count detail updated successfully!",description:"The count detail details have been updated."})},onError:s=>{let i="Something went wrong!";(L(s)||s instanceof Error)&&(i=s.message),m({title:"Failed to update count detail!",description:i,variant:"destructive"})}})}function le(){const{id:n}=k.useParams(),{data:r,error:o,isLoading:m}=P(),{data:s,error:i,isLoading:y}=H(n),C=J(n),t=E({resolver:A(Q),defaultValues:{is_active:(s==null?void 0:s.is_active)??!1,comments:(s==null?void 0:s.comments)??"",is_damaged:(s==null?void 0:s.is_damaged)??!1,quantity:(s==null?void 0:s.quantity)??1,unit_id:(s==null?void 0:s.unit.id)??""}}),{reset:g}=t;U.useEffect(()=>{s&&r&&g({is_active:s.is_active,comments:s.comments,is_damaged:s.is_damaged,quantity:s.quantity,unit_id:s==null?void 0:s.unit.id})},[s,r,g]);async function N(p){await C.mutateAsync(p)}const b=()=>s?e.jsx("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:`Update Count Detail (${s.count.name} | ${s.count_status})`}):e.jsx(B,{className:"w-52 h-8 rounded-md"}),_=()=>y||m?e.jsx(M,{}):o||i?e.jsxs("p",{className:"text-center text-red-500",children:["Error: ",(o==null?void 0:o.message)||(i==null?void 0:i.message)]}):r?s?e.jsx(T,{...t,children:e.jsxs("form",{className:"max-w-2xl",onSubmit:t.handleSubmit(N),children:[e.jsx("div",{className:"w-full grid gap-2",children:e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx(l,{children:"Bin"}),e.jsx(u,{placeholder:"",value:s.bin.name,disabled:!0})]})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx(l,{children:"Inventory"}),e.jsx(u,{placeholder:"",value:`[${s.inventory_id}] ${s.inventory_name}`,disabled:!0})]})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(d,{control:t.control,name:"quantity",render:({field:a})=>e.jsxs(x,{className:"w-full",children:[e.jsx(l,{children:"Quantity"}),e.jsx(h,{children:e.jsx(u,{placeholder:"Quantity",type:"number",...a,onChange:F=>a.onChange(F.target.valueAsNumber),required:!0})}),e.jsx(c,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(d,{control:t.control,name:"unit_id",render:({field:a})=>e.jsxs(x,{children:[e.jsx(l,{children:"Unit"}),e.jsx(K,{items:r??[],onValueChange:a.onChange,placeholder:"Select a unit",value:a.value}),e.jsx(c,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(d,{control:t.control,name:"is_active",render:({field:a})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{children:e.jsx(v,{checked:a.value,onCheckedChange:a.onChange})}),e.jsx(f,{className:"ml-1",htmlFor:"is_active",children:"is active"}),e.jsx(c,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(d,{control:t.control,name:"comments",render:({field:a})=>e.jsxs(x,{children:[e.jsx(l,{children:"Comments"}),e.jsx(G,{placeholder:"Comments",...a,onChange:a.onChange}),e.jsx(c,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(d,{control:t.control,name:"is_damaged",render:({field:a})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(h,{children:e.jsx(v,{checked:a.value,onCheckedChange:a.onChange})}),e.jsx(f,{className:"ml-1",htmlFor:"is_active",children:"is damaged"}),e.jsx(c,{})]})})}),e.jsx(I,{className:"w-full mt-8",isLoading:t.formState.isSubmitting,label:"Save",loadingLabel:"Saving...",type:"submit"})]})}):e.jsx("p",{className:"text-red-500",children:"Can't fetch count detail data."}):e.jsx("p",{className:"text-red-500",children:"Can't fetch units data."});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[b(),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update a count detail."})]})}),e.jsx("div",{children:_()})]})}export{le as component};
