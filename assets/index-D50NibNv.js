import{j as t,z as r,d as y,G as x,A as f,H as h}from"./index-DGcHplxd.js";import{a as C,D as j,q as v}from"./constants-CTS4Tt_R.js";import{e as I}from"./exportAllServerSide-BNtNfrwL.js";import{G as S}from"./GenericDataDisplay-B-3g5dGc.js";import{I as b}from"./ImportDataDialog-DYzS5LSh.js";import{u as A}from"./users-BBHnDepL.js";import{D as n,u as _,s as D,a as E}from"./tableSortMapper-Cn5pnBnO.js";import{u as N}from"./useUsers-DDgTWyQb.js";import{D as w}from"./DataTableRowActions-B4BMtG33.js";import"./skeleton-XLJxwfT3.js";import"./download-BArxJYpZ.js";import"./circle-plus-QHkNB0xz.js";import"./zod-hzm4Huev.js";import"./upload-Mv3Kev3e.js";const U=(a,o,e)=>`${a.original.employee_number} ${a.original.last_name} ${a.original.first_name}`.toLowerCase().includes(e.toLowerCase()),F=a=>{const o=[{accessorKey:"employee_number",header:({column:e})=>t.jsx(n,{column:e,title:"Employee #"}),cell:({row:e})=>{const s=e.original.is_active;return t.jsx("div",{className:r("max-w-[150px] font-medium",{"opacity-30":!s}),children:e.getValue("employee_number")})},filterFn:U},{accessorKey:"email",header:({column:e})=>t.jsx(n,{column:e,title:"Email"}),cell:({row:e})=>{const s=e.original.is_active;return t.jsx("div",{className:r("max-w-[200px]",{"opacity-30":!s}),children:e.getValue("email")})}},{accessorKey:"name",accessorFn:e=>`${e.last_name} ${e.first_name}`,header:({column:e})=>t.jsx(n,{column:e,title:"Name"}),cell:({row:e})=>{const s=e.original.is_active;return t.jsx("div",{className:r("max-w-[500px]",{"opacity-30":!s}),children:e.getValue("name")})}},{accessorKey:"role",header:({column:e})=>t.jsx(n,{column:e,title:"role"}),cell:({row:e})=>{const s=e.original.is_active;return t.jsx("div",{className:r("max-w-[100px]",{"opacity-30":!s}),children:e.getValue("role")})}}];return a==="admin"&&o.push({id:"actions",cell:({row:e})=>t.jsx(w,{editHref:`/users/${e.original.id}`,row:e})}),o};function P(){const{user:a}=y(),{filters:o,setFilters:e}=_(x.id),{data:s,isLoading:u}=N(o),p=f(),c={pageIndex:o.pageIndex??j,pageSize:o.pageSize??C},m=D(o.sortBy);function d(){p.invalidateQueries({queryKey:v.users.all})}if(a===null)return t.jsx("div",{});const l=["admin"].includes(a.role);return t.jsx(S,{allowCreation:l,allowExport:l,allowImport:l,addHref:"/users/new",addLabel:"Add User",columns:F(a.role),data:s,description:"Manage your users.",filterPlaceholder:"Search users by number or name...",importDialog:t.jsx(b,{onSuccess:d,processor:A,schema:h,templateUrl:"https://ngojeciepusvopacvqby.supabase.co/storage/v1/object/sign/templates/users.csv?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1cmwiOiJ0ZW1wbGF0ZXMvdXNlcnMuY3N2IiwiaWF0IjoxNzMyMTEyNzU3LCJleHAiOjMzMjM2NTc2NzU3fQ.CjSXbC6MiCLEWian5wx-X9Y1cDsGQeycTXcHZJaCWnI"}),isLoading:u,searchValue:o.q??"",onExportClick:async()=>I("users"),onSearchFieldChange:i=>{e({q:i,pageIndex:0})},onSortingChange:i=>{const g=typeof i=="function"?i(m):i;return e({sortBy:E(g)})},pagination:c,paginationOptions:{onPaginationChange:i=>{e(typeof i=="function"?i(c):i)},rowCount:s==null?void 0:s.total},sorting:m,title:"Users"})}export{P as component};
