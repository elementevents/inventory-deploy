import{z as g,u as v,b as S,m as y,at as F,n as N,au as b,r as q,j as e,F as w,o as l,p as x,q as h,t as c,I as f,v as d,ap as C}from"./index-nGUCknkE.js";import{t as E}from"./zod-DzKGMhXj.js";import{B as _}from"./Button-D1ndS-XF.js";import{F as L}from"./FormSkeleton-DE_934U1.js";import{u as k}from"./skeleton-BT0I12pU.js";import{q as m}from"./constants-CRsvxbNR.js";import{r as I,u as K}from"./stores-BGPt28mM.js";import{u as Q}from"./useMutation-36fkc0py.js";import{S as A}from"./switch-MxExDT8X.js";function M(r){return k({queryKey:m.stores.detail(r),queryFn:async()=>I(r)})}function R(r){const s=g(),o=v(),{toast:i}=S();return Q({mutationFn:a=>K(r,a),onSuccess:()=>{s.invalidateQueries({queryKey:m.stores.detail(r)}),s.invalidateQueries({queryKey:m.stores.lists()}),o({to:"/stores"}),i({title:"Store updated successfully!",description:"The store has been updated."})},onError:a=>{let t="Something went wrong!";(y(a)||a instanceof Error)&&(t=a.message),i({title:"Failed to update store!",description:t,variant:"destructive"})}})}function O(){const{id:r}=F.useParams(),{data:s,error:o,isLoading:i}=M(r),a=R(r),t=N({resolver:E(b),values:{name:(s==null?void 0:s.name)??"",address:(s==null?void 0:s.address)??"",is_active:(s==null?void 0:s.is_active)??!1}}),{reset:u}=t;q.useEffect(()=>{s&&u({name:s.name,address:s.address,is_active:s.is_active})},[s,u]);async function p(n){await a.mutateAsync(n)}const j=()=>i?e.jsx(L,{}):o?e.jsxs("p",{className:"text-red-500",children:["Error: ",o.message]}):s?e.jsx(w,{...t,children:e.jsxs("form",{className:"max-w-2xl",onSubmit:t.handleSubmit(p),children:[e.jsx("div",{className:"w-full grid gap-2",children:e.jsx(l,{control:t.control,name:"name",render:({field:n})=>e.jsxs(x,{className:"w-full",children:[e.jsx(h,{children:"Name"}),e.jsx(c,{children:e.jsx(f,{placeholder:"Store name",required:!0,...n})}),e.jsx(d,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(l,{control:t.control,name:"address",render:({field:n})=>e.jsxs(x,{children:[e.jsx(h,{children:"Address"}),e.jsx(c,{children:e.jsx(f,{placeholder:"Store address",required:!0,...n})}),e.jsx(d,{})]})})}),e.jsx("div",{className:"w-full grid gap-2 mt-4",children:e.jsx(l,{control:t.control,name:"is_active",render:({field:n})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{children:e.jsx(A,{checked:n.value,onCheckedChange:n.onChange})}),e.jsx(C,{className:"ml-2",htmlFor:"is_active",children:"Is active"}),e.jsx(d,{})]})})}),e.jsx(_,{className:"w-full mt-8",isLoading:t.formState.isSubmitting,label:"Save",loadingLabel:"Saving...",type:"submit"})]})}):e.jsx("p",{className:"text-red-500",children:"Can't fetch store data."});return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col space-y-1.5",children:[e.jsx("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:"Update Store"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update store details."})]})}),e.jsx("div",{children:j()})]})}export{O as component};
